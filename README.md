# 問い合わせフォーム メール送信構成（Google Apps Script）

## 概要

本問い合わせフォームは、**バックエンドサーバーを持たず**、
Google Apps Script（以下 GAS）を用いて **静的HTMLページから直接メール送信**を行う構成となっています。

* フロントエンド：静的HTML（LP）
* バックエンド相当：Google Apps Script（Web アプリ）
* メール送信：GmailApp（Googleのメール基盤）

外部フォームサービスやSMTPサーバーは使用していません。

---

## 全体構成図（論理）

```
[ ユーザー ]
   ↓ フォーム送信（POST）
[ 静的HTML（LP） ]
   ↓
[ Google Apps Script（Webアプリ） ]
   ├ 管理者通知メール送信
   └ 問い合わせ者 自動返信メール送信
```

---

## メール送信フロー

### 1. フォーム送信

ユーザーが LP 上の問い合わせフォームを送信すると、
HTML form の POST により GAS の Web アプリ URL（/exec）にリクエストが送られます。

* ログイン不要
* JavaScript不要
* 完全に静的ページで動作

---

### 2. Google Apps Script での処理

GAS の `doPost(e)` がエントリポイントとなり、以下を実行します。

1. POST パラメータを取得
2. 入力内容のバリデーション
3. メール本文の生成
4. 管理者向け通知メール送信
5. 問い合わせ者向け自動返信メール送信
6. 完了画面（HTML）をレスポンスとして返却

---

## 管理者向け通知メール

### 目的

* 新規問い合わせの即時把握
* 問い合わせ内容の確認

### 仕様

| 項目       | 内容                                                           |
| -------- | ------------------------------------------------------------ |
| To       | [contact@jboundex.com](mailto:contact@jboundex.com)（管理者アドレス） |
| From     | [contact@jboundex.com](mailto:contact@jboundex.com)          |
| Reply-To | 問い合わせ者のメールアドレス                                               |
| 件名       | `[日本市場テスト相談] 会社名 / 国`                                        |
| 本文       | フォーム入力内容をテキスト形式で整形                                           |

返信操作を行うと、直接問い合わせ者へ返信できます。

---

## 問い合わせ者向け自動返信メール

### 目的

* 送信完了の通知
* 安心感の提供
* 連絡待ち時間の明示

### 仕様

| 項目       | 内容                                                  |
| -------- | --------------------------------------------------- |
| To       | 問い合わせ者のメールアドレス                                      |
| From     | [contact@jboundex.com](mailto:contact@jboundex.com) |
| Reply-To | [contact@jboundex.com](mailto:contact@jboundex.com) |
| 件名       | 日本市場テストのご相談ありがとうございます（JBoundex）                     |
| 本文       | 受付完了メッセージ＋送信内容の要約                                   |

---

## From アドレスについて

* GAS は **実行アカウントの Gmail を通じて送信**されます
* `contact@jboundex.com` は Gmail の **Send-as（送信エイリアス）** として登録されています
* GAS 側で `from: "contact@jboundex.com"` を明示指定しています

これにより、

* 実際の送信主体：管理者Googleアカウント
* 表示上の送信元：[contact@jboundex.com](mailto:contact@jboundex.com)

という構成を実現しています。

---

## GAS Web アプリ設定

| 設定項目   | 値            |
| ------ | ------------ |
| 実行ユーザー | 自分（管理者アカウント） |
| アクセス権  | 全員（匿名含む）     |

### この設定の意味

* フォーム利用者に Google ログインや権限許可は不要
* Gmail 送信権限は管理者アカウントのみが保持
* 初回のみ管理者が Gmail 利用許可を承認

---

## 料金・制限について

### 料金

* Google Apps Script / GmailApp は **無料**

### 主な制限（目安）

| 項目     | 制限                             |
| ------ | ------------------------------ |
| メール送信数 | 約 1,500通 / 日（Google Workspace） |
| 実行時間   | 1リクエスト 約30秒                    |
| 同時実行   | LP用途では実質問題なし                   |

一般的な問い合わせフォーム用途では、制限に達することはほぼありません。

---

## セキュリティ上の考慮点

現時点で満たしている点：

* SMTP認証情報を外部に持たない
* 外部フォームサービスを経由しない
* GAS の実行主体を管理者に固定
* ユーザー側に権限付与不要

将来的に必要に応じて追加可能な対策：

* 連続送信制限
* hidden フィールドによる Bot 対策
* 送信ログのスプレッドシート保存

---

## 運用上の補足

* Web アプリのコード変更時は **必ず再デプロイ**すること
* 月1回程度のテスト送信を推奨
* Gmail の Send-as 設定が外れると FROM が戻るため注意

---

## まとめ

本問い合わせフォームは

* 静的サイトのみで完結
* 外部サービス非依存
* 無料で長期運用可能
* 管理・拡張が容易

という特徴を持ち、
**LP用の問い合わせフォームとして実用レベルかつ安全な構成**となっています。


